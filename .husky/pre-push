BRANCH_POINT=$(git merge-base main $(git branch --show-current))
COUNT=$(git rev-list --count $BRANCH_POINT..HEAD)

commits=($(git log $(git branch --show-current) --format="%H" --first-parent -$COUNT))

# Получаем статус только для папки ./backend
backend_changes=$(git status --porcelain ./backend/src 2>/dev/null)
echo "->> $backend_changes ..."

# Проверяем, есть ли изменения
if [ -n "$backend_changes" ]
then
    echo "Выполняются действия для изменений в backend..."

    gs1=$(git status)

    cd ./backend
    npm run generate
    cd ../
    
    gs2=$(git status)
    if [ "$gs1" != "$gs2" ]
    then
        echo "Выполняются действия git..."
        git add ./backend && git commit -m "Backend changes"
    fi

    exit 0
fi
